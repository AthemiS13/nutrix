@import "tailwindcss";

/*
	Ensure the status bar / safe-area on iOS standalone (added to Home Screen)
	uses the app background and that content is padded away from the
	Dynamic Island / notch using env(safe-area-inset-*) with fallbacks.

	env(...) returns 0 on platforms without safe-area insets, so this is
	safe to add globally.
*/

:root {
	/* Use the same neutral color variable used by Tailwind in your app so
	   the header/background match exactly */
	--app-bg: var(--color-neutral-950);
	
	/* Use dvh (dynamic viewport height) to prevent layout shift when keyboard opens.
	   Falls back to 100vh for browsers that don't support dvh */
	--app-height: 100vh; /* Fallback for older browsers */
	--app-height: 100dvh; /* Modern browsers with dvh support */
	
	/* Define fixed heights for header and nav to calculate content area 
	   Nav height is just the visual height, safe-area padding is separate */
	--header-height: calc(env(safe-area-inset-top, 0px) + 3.5rem);
	--nav-height: 3rem;
	--nav-safe-area: env(safe-area-inset-bottom, 0px);
}

/* Support for older browsers that don't have dvh */
@supports not (height: 100dvh) {
	:root {
		--app-height: 100vh;
	}
}

/* Fixed height container to prevent reflow when keyboard appears */
html, body, #__next {
	width: 100%;
	height: var(--app-height);
	margin: 0;
	padding: 0;
	overflow: hidden;
	background-color: var(--app-bg);
	/* Lock html and body in place - prevent ANY movement */
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	/* Prevent touch scrolling on body */
	touch-action: none;
	overscroll-behavior: none;
}

body {
	margin: 0;
	/* don't apply global safe-area padding here â€” scope to header/footer
	   so the whole layout doesn't shift unexpectedly (we'll use helpers)
	*/
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
	/* Prevent overscroll bounce */
	overscroll-behavior: none;
}

/* helper classes in case you want to scope safe-area handling to a header */
.safe-top {
	padding-top: constant(safe-area-inset-top);
	padding-top: env(safe-area-inset-top);
}

/* Apply to fixed bottom navigation to ensure it sits above the home indicator
	 / dynamic island. Use padding so the clickable area remains comfortable. */
.safe-bottom {
	padding-bottom: constant(safe-area-inset-bottom);
	padding-bottom: env(safe-area-inset-bottom);
}

nav.safe-bottom {
	/* help reduce repaint jank when the viewport changes on mobile */
	-webkit-transform: translateZ(0);
	transform: translateZ(0);
	will-change: transform;
}

/* Nudge the fixed nav slightly downward on devices with a home indicator
	 so it visually sits closer to the phone's rounded corners without
	 clipping the interactive area. The translate uses half the inset so
	 we don't push the nav outside the viewport. */
nav.safe-bottom {
    /* keep nav pinned to bottom exactly; avoid visual downward nudge that can clip or feel too low */
    transform: translateY(0);
}

/* Utility to anchor fixed elements to the true bottom in case some browsers
	 report a non-zero inset via bottom env(). Use with caution; we prefer
	 padding so elements aren't visually clipped. */
.anchor-bottom-safe {
	/* Keep the nav element visually anchored to the bottom of the
		 viewport (bottom: 0). We keep padding on the nav itself to honor
		 the safe-area so buttons aren't clipped by the home indicator. */
	bottom: 0;
}

/* App layout components to prevent keyboard-induced layout shift */
.app-container {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	width: 100%;
	height: var(--app-height);
	max-height: var(--app-height);
	min-height: var(--app-height);
	overflow: hidden;
	display: flex;
	flex-direction: column;
	/* Prevent ALL scrolling on the container itself */
	touch-action: none;
	overscroll-behavior: none;
	/* Lock it in place */
	transform: translate3d(0, 0, 0);
	will-change: auto;
}

.app-header {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	z-index: 1000;
	height: var(--header-height);
	max-height: var(--header-height);
	min-height: var(--header-height);
	padding-top: env(safe-area-inset-top, 0px);
	/* Ensure header stays put during keyboard transitions */
	backface-visibility: hidden;
	-webkit-backface-visibility: hidden;
	/* Prevent scrolling on header */
	touch-action: none;
	pointer-events: auto;
	/* Force position - critical for mobile */
	transform: translate3d(0, 0, 0);
	will-change: auto;
}

.app-content {
	position: fixed;
	top: var(--header-height);
	bottom: calc(var(--nav-height) + var(--nav-safe-area));
	left: 0;
	right: 0;
	overflow-y: auto;
	overflow-x: hidden;
	-webkit-overflow-scrolling: touch;
	/* Smooth scrolling behavior */
	scroll-behavior: smooth;
	/* Prevent momentum scrolling from affecting layout */
	overscroll-behavior: contain;
	/* Allow scrolling only in content area */
	touch-action: pan-y;
	/* Lock content area dimensions */
	transform: translate3d(0, 0, 0);
}

.app-nav {
	position: fixed;
	bottom: 0 !important;
	left: 0;
	right: 0;
	z-index: 1000;
	height: calc(var(--nav-height) + var(--nav-safe-area));
	max-height: calc(var(--nav-height) + var(--nav-safe-area));
	min-height: calc(var(--nav-height) + var(--nav-safe-area));
	padding-bottom: var(--nav-safe-area);
	/* Ensure nav stays put during keyboard transitions */
	backface-visibility: hidden;
	-webkit-backface-visibility: hidden;
	/* Use GPU acceleration and force exact positioning */
	transform: translate3d(0, 0, 0);
	-webkit-transform: translate3d(0, 0, 0);
	will-change: auto;
	/* Prevent scrolling on nav */
	touch-action: none;
	pointer-events: auto;
	/* Additional positioning */
	margin: 0;
	display: flex;
	align-items: stretch;
}

/* Remove the visible blue focus ring that appears when some SVG/chart
	 elements receive focus on mobile (tap) or keyboard. We scope this to
	 Recharts-generated SVGs so we don't remove global focus styles.
	 Keep in mind removing outlines can hurt keyboard users; we only
	 remove the ring for visual polish here since the controls have
	 other accessible affordances. */
.recharts-wrapper :focus,
.recharts-wrapper svg :focus {
	outline: none !important;
	box-shadow: none !important;
}

/* Also remove focus from chart legend / interactive nodes that Recharts may
	 attach tabIndex to on mobile taps (pie slices, legend items). */
.recharts-legend-item :focus,
.recharts-legend-item:focus,
.recharts-surface :focus {
	outline: none !important;
	box-shadow: none !important;
}

/*
	Hide native scrollbars on mobile / touch devices to provide an app-like
	experience. We keep content scrollable but remove the persistent white
	scrollbar that can appear on some platforms when used like an app.

	- For Firefox: scrollbar-width: none
	- For IE/Edge legacy: -ms-overflow-style: none
	- For WebKit: set scrollbar width/height to 0 and transparent track

	We scope this to smaller viewports and coarse pointers to avoid hiding
	scrollbars for desktop users who rely on them.
*/
@media (max-width: 1024px) and (pointer: coarse) {
	html, body, #__next {
		scrollbar-width: none; /* Firefox */
		-ms-overflow-style: none; /* IE 10+ */
	}

	/* WebKit browsers */
	html::-webkit-scrollbar,
	body::-webkit-scrollbar,
	#__next::-webkit-scrollbar {
		width: 0;
		height: 0;
		background: transparent;
	}

	/* Smooth native-like scrolling on iOS */
	* {
		-webkit-overflow-scrolling: touch;
	}
}

